<% content_for :title, "Devis gratuit - Élagage Dubois | Expert en élagage, abattage et dessouchage" %>
<% content_for :description, "Demandez votre devis gratuit pour vos travaux d'élagage, d'abattage ou de dessouchage. Réponse rapide sous 24h. Contactez-nous !" %>
<% content_for :keywords, "devis gratuit, élagage, abattage, dessouchage, devis, contact, Élagage Dubois, Île-de-France" %>
<% content_for :og_title, "Devis gratuit - Élagage Dubois" %>
<% content_for :og_description, "Demandez votre devis gratuit pour vos travaux d'élagage, d'abattage ou de dessouchage. Réponse rapide sous 24h." %>
<% content_for :og_image, "https://elagage-dubois-v2.scalingo.io/icon.png" %>

<%= render "components/header" %>

<div class="isolate relative bg-white pt-32">
  <div class="grid grid-cols-1 mx-auto max-w-7xl lg:grid-cols-2">
    <!-- Colonne de gauche : Informations -->
    <div class="relative px-6 pt-12 pb-20 sm:pt-20 lg:static lg:px-8 lg:py-24">
      <div class="mx-auto max-w-xl lg:mx-0 lg:max-w-lg">
        <h2 class="text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl">Vous souhaitez un devis sur mesure ?</h2>
        <p class="mt-6 text-lg leading-8 text-gray-600">
          Remplissez notre formulaire de devis en ligne, en moins de 24 heures, vous recevrez l'estimation pour vos travaux. Nos experts se mobiliseront pour vous offrir un devis détaillé et personnalisé, parfaitement adapté à vos besoins. Bénéficiez de notre savoir-faire pour réaliser vos projets avec confiance.
        </p>
        
        <div class="p-6 mt-8 bg-green-50 rounded-lg border border-green-200">
          <h3 class="mb-3 text-lg font-semibold text-gray-900">Vous êtes basé dans le Val d'Oise, l'Oise ou les Yvelines ?</h3>
          <p class="text-sm leading-relaxed text-gray-700">
            Ne perdez plus de temps ! Demandez votre devis gratuit et sans engagement et recevez une estimation pour vos travaux personnalisés dans le plus bref délai. Nos experts sont à votre écoute pour vous offrir un service rapide et vous accompagner dans vos projets.
          </p>
        </div>
        
        <div class="p-6 mt-8 bg-white rounded-lg border border-gray-200 shadow-sm">
          <h3 class="mb-4 text-lg font-semibold text-gray-900">Contactez Dubois Services</h3>
          <dl class="space-y-4 text-base text-gray-600">
            <div class="flex gap-x-4">
              <dt class="flex-none">
                <span class="sr-only">Téléphone</span>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-6 h-6 text-green-600">
                  <path d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </dt>
              <dd>
                <a href="tel:<%= company_phone_formatted %>" class="font-semibold text-gray-900 hover:text-green-700"><%= company_phone %></a><br />
                <span class="text-sm text-gray-500">Disponible du lundi au samedi</span>
              </dd>
            </div>
            <div class="flex gap-x-4">
              <dt class="flex-none">
                <span class="sr-only">Email</span>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-6 h-6 text-green-600">
                  <path d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </dt>
              <dd>
                <a href="mailto:jpdubois.services@gmail.com" class="font-semibold text-gray-900 hover:text-green-700">jpdubois.services@gmail.com</a><br />
                <span class="text-sm text-gray-500">Réponse sous 24h</span>
              </dd>
            </div>
          </dl>
        </div>
      </div>
    </div>
    
    <!-- Colonne de droite : Formulaire -->
    <%= form_with model: @quote, url: create_quote_path, local: true, class: "px-6 pt-12 pb-24 sm:pb-32 lg:px-8 lg:py-24" do |form| %>
      <div class="mx-auto max-w-xl lg:mr-0 lg:max-w-lg">
        
        <!-- Messages de notification -->
        <% if flash[:success] %>
          <div class="p-4 mb-6 bg-green-50 rounded-lg border border-green-200">
            <div class="flex">
              <div class="flex-shrink-0">
                <svg class="w-5 h-5 text-green-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
              </div>
              <div class="ml-3">
                <p class="text-sm font-medium text-green-800"><%= flash[:success] %></p>
              </div>
            </div>
          </div>
        <% end %>

        <% if flash[:error] %>
          <div class="p-4 mb-6 bg-red-50 rounded-lg border border-red-200">
            <div class="flex">
              <div class="flex-shrink-0">
                <svg class="w-5 h-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                </svg>
              </div>
              <div class="ml-3">
                <p class="text-sm font-medium text-red-800"><%= flash[:error] %></p>
              </div>
            </div>
          </div>
        <% end %>

        <div class="space-y-6">
          
          <!-- Nom et Prénom -->
          <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
            <div>
              <%= form.label :prenom, "Prénom <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
              <%= form.text_field :prenom, required: true, 
                  class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:prenom].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500" %>
              <% if @quote.errors[:prenom].any? %>
                <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:prenom].first %></p>
              <% end %>
            </div>
            <div>
              <%= form.label :nom, "Nom <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
              <%= form.text_field :nom, required: true,
                  class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:nom].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500" %>
              <% if @quote.errors[:nom].any? %>
                <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:nom].first %></p>
              <% end %>
            </div>
          </div>

          <!-- E-mail -->
          <div>
            <%= form.label :email, "E-mail <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.email_field :email, required: true,
                class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:email].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500" %>
            <% if @quote.errors[:email].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:email].first %></p>
            <% end %>
          </div>

          <!-- Téléphone -->
          <div>
            <%= form.label :telephone, "Téléphone <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.telephone_field :telephone, required: true,
                class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:telephone].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",
                placeholder: company_phone %>
            <% if @quote.errors[:telephone].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:telephone].first %></p>
            <% end %>
          </div>

          <!-- Service souhaité -->
          <div>
            <%= form.label :service_souhaite, "Service souhaité <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.select :service_souhaite, 
                options_for_select([
                  ["Sélectionnez un service", ""],
                  ["Élagage", "elagage"],
                  ["Abattage", "abattage"],
                  ["Dessouchage", "dessouchage"],
                  ["Entretien de jardin", "entretien"],
                  ["Taille de haies", "taille_haies"],
                  ["Création et tonte de pelouse", "tonte_pelouse"],
                  ["Débroussaillage", "debroussaillage"],
                  ["Autre", "autre"]
                ], @quote.service_souhaite), 
                { required: true },
                { class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:service_souhaite].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500" } %>
            <% if @quote.errors[:service_souhaite].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:service_souhaite].first %></p>
            <% end %>
          </div>

          <!-- Détail de la demande -->
          <div>
            <%= form.label :commentaires, "Détail de la demande <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.text_area :commentaires, rows: 6, required: true,
                class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:commentaires].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",
                placeholder: "Décrivez votre projet en détail : type d'intervention souhaitée, nombre d'arbres, accessibilité, contraintes particulières, etc." %>
            <% if @quote.errors[:commentaires].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:commentaires].first %></p>
            <% end %>
          </div>

          <!-- Accord RGPD -->
          <div>
            <div class="flex items-start">
              <%= form.check_box :rgpd_accepted, required: true,
                  class: "mt-1 w-4 h-4 text-green-600 rounded border-gray-300 focus:ring-green-500" %>
              <%= form.label :rgpd_accepted, 
                  "J'accepte que mes données soient utilisées pour traiter ma demande de devis. #{link_to 'Politique de confidentialité', '/politique-confidentialite', class: 'text-green-700 underline hover:text-green-800'}.".html_safe,
                  class: "ml-3 text-sm text-gray-700" %>
            </div>
            <% if @quote.errors[:rgpd_accepted].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:rgpd_accepted].first %></p>
            <% end %>
          </div>

        </div>
        
        <div class="mt-8">
          <%= form.submit "Envoyer ma demande de devis", 
              class: "w-full px-8 py-4 text-lg font-semibold rounded-lg shadow-lg transition-all hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",
              style: "background: linear-gradient(to right, #16a34a, #15803d); color: white; border: none;" %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<%= render "components/footer" %>
