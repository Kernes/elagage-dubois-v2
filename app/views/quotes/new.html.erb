<% content_for :title, "Devis gratuit - Élagage Dubois | État des lieux professionnel" %>
<% content_for :description, "Demandez votre devis gratuit pour un état des lieux professionnel en Île-de-France. Réponse rapide sous 24h. Contactez-nous !" %>
<% content_for :keywords, "devis gratuit, état des lieux, devis, contact, Élagage Dubois, Île-de-France, Guyancourt, Yvelines" %>
<% content_for :og_title, "Devis gratuit - Élagage Dubois | État des lieux professionnel" %>
<% content_for :og_description, "Demandez votre devis gratuit pour un état des lieux professionnel en Île-de-France. Réponse rapide sous 24h. Contactez-nous !" %>
<% content_for :og_image, "https://elagage-dubois-v2.scalingo.io/icon.png" %>

<!-- Breadcrumb pour la page Devis -->
<% content_for :head do %>
  <script type="application/ld+json">
  <%= raw structured_data_breadcrumb([
    { name: "Accueil", url: "https://elagage-dubois-v2.scalingo.io/" },
    { name: "Devis", url: "https://elagage-dubois-v2.scalingo.io/devis" }
  ]).to_json %>
  </script>
<% end %>

<%= render "components/header_standard" %>
<div class="isolate relative bg-white">
  <div class="grid grid-cols-1 mx-auto max-w-7xl lg:grid-cols-2">
    <div class="relative px-6 pt-24 pb-20 sm:pt-32 lg:static lg:px-8 lg:py-48">
      <div class="mx-auto max-w-xl lg:mx-0 lg:max-w-lg">
        <div class="overflow-hidden absolute inset-y-0 left-0 w-full bg-white bg-gray-100 ring-1 -z-10 ring-gray-900/10 lg:w-1/2">
          <div aria-hidden="true" class="absolute top-[calc(100%-13rem)] -left-56 hidden transform-gpu blur-3xl lg:top-[calc(50%-7rem)] lg:left-[max(-14rem,calc(100%-59rem))]">
            <div style="clip-path: polygon(74.1% 56.1%, 100% 38.6%, 97.5% 73.3%, 85.5% 100%, 80.7% 98.2%, 72.5% 67.7%, 60.2% 37.8%, 52.4% 32.2%, 47.5% 41.9%, 45.2% 65.8%, 27.5% 23.5%, 0.1% 35.4%, 17.9% 0.1%, 27.6% 23.5%, 76.1% 2.6%, 74.1% 56.1%)" class="aspect-1155/678 w-288.75 bg-linear-to-br from-[#80caff] to-[#4f46e5] opacity-10"></div>
          </div>
        </div>
        <h2 class="text-4xl font-semibold tracking-tight text-gray-900 text-pretty sm:text-5xl">Vous souhaitez un devis d'état des lieux sur mesure ?</h2>
        <p class="mt-6 text-gray-600 text-lg/8">Remplissez notre formulaire de devis en ligne, en moins de 24 heures, vous recevrez l'estimation pour votre état des lieux. Nos experts se mobiliseront pour vous offrir un état des lieux numérique et détaillé, parfaitement adapté à vos besoins. Bénéficiez de notre savoir-faire pour sécuriser votre transaction immobilière avec confiance.</p>
        
        <div class="p-4 mt-8 bg-indigo-50 rounded-lg">
          <h3 class="mb-2 text-lg font-semibold text-indigo-900">Vous êtes basé dans les Yvelines ou en Île-de-France ?</h3>
          <p class="text-sm text-indigo-800">Ne perdez plus de temps ! Demandez votre devis gratuit et sans engagement et recevez une estimation pour votre état des lieux personnalisé dans le plus bref délai. Nos experts sont à votre écoute pour vous offrir un service rapide et vous accompagner dans votre transaction immobilière.</p>
        </div>
        <div class="p-6 mt-10 bg-gray-50 rounded-lg">
          <h3 class="mb-4 text-lg font-semibold text-gray-900">Contactez Élagage Dubois</h3>
          <dl class="space-y-4 text-gray-600 text-base/7">
            <div class="flex gap-x-4">
              <dt class="flex-none">
                <span class="sr-only">Téléphone</span>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-slot="icon" aria-hidden="true" class="w-6 h-7 text-gray-400">
                  <path d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </dt>
              <dd>
                <a href="tel:+33783892384" class="font-semibold text-gray-900 hover:text-indigo-600">07 83 89 23 84</a><br />
                <span class="text-sm text-gray-500">Disponible 6 jours sur 7</span>
              </dd>
            </div>
            <div class="flex gap-x-4">
              <dt class="flex-none">
                <span class="sr-only">Email</span>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-slot="icon" aria-hidden="true" class="w-6 h-7 text-gray-400">
                  <path d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </dt>
              <dd>
                <a href="mailto:sqy.etatdeslieux@gmail.com" class="font-semibold text-gray-900 hover:text-indigo-600">sqy.etatdeslieux@gmail.com</a><br />
                <span class="text-sm text-gray-500">Réponse sous 24h</span>
              </dd>
            </div>
          </dl>
        </div>
      </div>
    </div>
    <%= form_with model: @quote, url: create_quote_path, local: true, class: "px-6 pt-20 pb-24 sm:pb-32 lg:px-8 lg:py-48" do |form| %>
      <div class="mx-auto max-w-xl lg:mr-0 lg:max-w-lg">
        
        <!-- Messages de notification -->
        <% if flash[:success] %>
          <div class="p-4 mb-6 bg-green-50 rounded-lg border border-green-200">
            <div class="flex">
              <div class="flex-shrink-0">
                <svg class="w-5 h-5 text-green-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                </svg>
              </div>
              <div class="ml-3">
                <p class="text-sm font-medium text-green-800"><%= flash[:success] %></p>
              </div>
            </div>
          </div>
        <% end %>

        <% if flash[:error] %>
          <div class="p-4 mb-6 bg-red-50 rounded-lg border border-red-200">
            <div class="flex">
              <div class="flex-shrink-0">
                <svg class="w-5 h-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                </svg>
              </div>
              <div class="ml-3">
                <p class="text-sm font-medium text-red-800"><%= flash[:error] %></p>
              </div>
            </div>
          </div>
        <% end %>

        <div class="space-y-6">
          
          <!-- Nom -->
          <div>
            <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
              <div>
                <%= form.label :prenom, "Prénom <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-medium text-gray-700" %>
                <%= form.text_field :prenom, required: true, 
                    class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:prenom].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" %>
                <% if @quote.errors[:prenom].any? %>
                  <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:prenom].first %></p>
                <% end %>
              </div>
              <div>
                <%= form.label :nom, "Nom <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-medium text-gray-700" %>
                <%= form.text_field :nom, required: true,
                    class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:nom].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" %>
                <% if @quote.errors[:nom].any? %>
                  <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:nom].first %></p>
                <% end %>
              </div>
            </div>
          </div>

          <!-- E-mail -->
          <div>
            <%= form.label :email, "E-mail <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.email_field :email, required: true,
                class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:email].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" %>
            <% if @quote.errors[:email].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:email].first %></p>
            <% end %>
          </div>

          <!-- Téléphone -->
          <div>
            <%= form.label :telephone, "Téléphone", class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.telephone_field :telephone,
                class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:telephone].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",
                placeholder: "07 83 89 23 84" %>
            <% if @quote.errors[:telephone].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:telephone].first %></p>
            <% end %>
          </div>

          <!-- Type d'états des lieux -->
          <div>
            <label class="block mb-4 text-sm font-semibold text-gray-900">
              Type d'états des lieux <span class="text-red-500">*</span>
            </label>
            <div class="flex space-x-6">
              <div class="flex items-center">
                <%= form.radio_button :type_etat, "entree", required: true, 
                    class: "w-4 h-4 text-indigo-600 border-gray-300 focus:ring-indigo-500" %>
                <%= form.label :type_etat_entree, "États des lieux d'entrée", class: "ml-3 text-sm font-medium text-gray-700" %>
              </div>
              <div class="flex items-center">
                <%= form.radio_button :type_etat, "sortie", required: true,
                    class: "w-4 h-4 text-indigo-600 border-gray-300 focus:ring-indigo-500" %>
                <%= form.label :type_etat_sortie, "États des lieux de sortie", class: "ml-3 text-sm font-medium text-gray-700" %>
              </div>
            </div>
            <% if @quote.errors[:type_etat].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:type_etat].first %></p>
            <% end %>
          </div>

          <!-- Type de bien -->
          <div>
            <%= form.label :type_bien, "Type de bien <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.select :type_bien, 
                options_for_select([
                  ["Sélectionnez un type de bien", ""],
                  ["Maisons individuelles", "maison"],
                  ["Appartements", "appartement"],
                  ["Studios", "studio"],
                  ["Lofts", "loft"],
                  ["Autre", "autre"]
                ], @quote.type_bien.present? ? @quote.type_bien : "maison"), 
                { required: true },
                { class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:type_bien].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" } %>
            <% if @quote.errors[:type_bien].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:type_bien].first %></p>
            <% end %>
          </div>

          <!-- Surface du bien -->
          <div>
            <%= form.label :surface, "Surface du bien (m²) <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.number_field :surface, min: 0, step: 0.1, required: true,
                class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:surface].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" %>
            <% if @quote.errors[:surface].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:surface].first %></p>
            <% end %>
          </div>

          <!-- Nombre de pièces -->
          <div>
            <%= form.label :pieces, "Nombre de pièces <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <div class="space-y-2">
              <%= form.range_field :pieces, min: 1, max: 10, value: @quote.pieces || 1, required: true,
                  class: "w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider" %>
              <div class="text-sm text-gray-600">Valeur sélectionnée : <span id="pieces-value"><%= @quote.pieces || 1 %></span></div>
            </div>
            <% if @quote.errors[:pieces].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:pieces].first %></p>
            <% end %>
          </div>

          <!-- Adresse du bien -->
          <div>
            <%= form.label :adresse, "Adresse du bien <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.text_area :adresse, rows: 3, required: true,
                class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:adresse].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" %>
            <% if @quote.errors[:adresse].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:adresse].first %></p>
            <% end %>
          </div>

          <!-- Ville et Code postal -->
          <div class="grid grid-cols-1 gap-4 sm:grid-cols-2">
            <div>
              <%= form.label :ville, "Ville <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
              <%= form.text_field :ville, required: true,
                  class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:ville].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" %>
              <% if @quote.errors[:ville].any? %>
                <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:ville].first %></p>
              <% end %>
            </div>
            <div>
              <%= form.label :code_postal, "Code postal <span class='text-red-500'>*</span>".html_safe, class: "block mb-2 text-sm font-semibold text-gray-900" %>
              <%= form.text_field :code_postal, value: @quote.code_postal, required: true,
                  class: "block px-3 py-2 w-full rounded-md border #{'border-red-300 bg-red-50' if @quote.errors[:code_postal].any?} border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" %>
              <% if @quote.errors[:code_postal].any? %>
                <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:code_postal].first %></p>
              <% end %>
            </div>
          </div>

          <!-- Précisions/Commentaires -->
          <div>
            <%= form.label :commentaires, "Des précisions ? Un Commentaire ?", class: "block mb-2 text-sm font-semibold text-gray-900" %>
            <%= form.text_area :commentaires, rows: 4,
                class: "block px-3 py-2 w-full rounded-md border border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" %>
          </div>

          <!-- Accord RGPD -->
          <div>
            <div class="flex items-start">
              <%= form.check_box :rgpd_accepted, required: true,
                  class: "mt-1 w-4 h-4 text-indigo-600 rounded border-gray-300 focus:ring-indigo-500" %>
              <%= form.label :rgpd_accepted, 
                  "J'accepte que mes données soient utilisées pour traiter ma demande de devis. #{link_to 'Politique de confidentialité', '/politique-confidentialite', class: 'text-indigo-600 underline hover:text-indigo-500'}.".html_safe,
                  class: "ml-3 text-sm text-gray-700" %>
            </div>
            <% if @quote.errors[:rgpd_accepted].any? %>
              <p class="mt-1 text-sm text-red-600"><%= @quote.errors[:rgpd_accepted].first %></p>
            <% end %>
          </div>

        </div>
        <div class="flex justify-center mt-8">
          <%= form.submit "Envoyer ma demande de devis", 
              class: "px-8 py-3 text-lg font-semibold text-center text-white bg-indigo-600 rounded-md shadow-lg transition-colors hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2" %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<script>
// Script pour le slider du nombre de pièces
document.getElementById('quote_pieces').addEventListener('input', function() {
  document.getElementById('pieces-value').textContent = this.value;
});
</script>

<style>
.slider::-webkit-slider-thumb {
  appearance: none;
  height: 20px;
  width: 20px;
  border-radius: 50%;
  background: #4f46e5;
  cursor: pointer;
  box-shadow: 0 0 2px 0 #555;
}

.slider::-moz-range-thumb {
  height: 20px;
  width: 20px;
  border-radius: 50%;
  background: #4f46e5;
  cursor: pointer;
  border: none;
  box-shadow: 0 0 2px 0 #555;
}
</style>

<%= render "components/footer" %>
